<!-- begin page-header -->
<%= render 'layouts/static/header', header_title: 'Locations', sub_header_title: 'Create/Edit/View'%>
<!-- end page-header -->
<!-- begin panel -->
<div class="panel panel-inverse">
  <div class="panel-heading">
    <div class="panel-heading-btn">
    </div>
    <h4 class="panel-title"> <%= params[:action] == 'new' ? 'Create New Location' : "Edit Location - #{client_location.name}"%></h4>
  </div>
  <div class="panel-body">
  <%= form_with(model: client_location, local: true, :html => {class: 'form-horizontal', 'data-parsley-validate' => true}) do |form| %>
  <%= form.hidden_field :client_id %>
  <% if client_location.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(client.errors.count, "error") %> prohibited this client from being saved:</h2>

      <ul>
      <% client.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

                <div class="form-group row m-b-15">
                  <%= form.label :name, 'Location Name :', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
                  <div class="col-md-8 col-sm-8">
                  <%= form.text_field :name, class: 'form-control' %>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <%= form.label :loc_type, 'Type :', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
                  <div class="col-md-8 col-sm-8">
                  <%= form.select :loc_type, options_for_select(['Plant', 'Warehouse', 'DC', 'Supplier', 'Customer', 'Third Party'], client_location.loc_type),{:include_blank => true}, class: 'form-control' %>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <label class="text-right col-md-2 col-sm-4 col-form-label"> is Head Office or MCR? <i>(Need to input address fields)</i></label>
                  <div class="col-md-8 col-sm-8">
                    <input type="checkbox" name="head_office" data-render="switchery" data-theme="default" data-secondary-color="rgb(255, 91, 87)" data-change="check-switchery-state-same-office"  <%= is_head_office ? 'checked' : '' %>/>
                  </div>
                </div>
                <div class="form-group row m-b-15 head-office-fields">
                  <label class="text-right col-md-2 col-sm-4 col-form-label">same as Head Office or Master Client Record? </label>
                  <div class="col-md-8 col-sm-8">
                    <input type="checkbox" name="same_ho" data-render="switchery" data-theme="default" data-secondary-color="rgb(255, 91, 87)" data-change="check-switchery-state-text"  <%= client_location.same_ho ? 'checked' : '' %>/>
                  </div>
                </div>

                <%= render 'clients/address_form', form: form %>
                <div class="form-group row m-b-15 address-fields">
                  <%= form.label :phone, 'Phone #:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
                  <div class="col-md-8 col-sm-8">
                  <%= form.text_field :phone, class: 'form-control', 'data-inputmask' => "'mask': '(999) 999-9999'" %>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <%= form.label :poc_id, 'Primary Ops Contact:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
                  <div class="col-md-8 col-sm-8">
                  <%= form.select :poc_id, ClientContact.where(:client_id => client_location.client_id).collect {|r| [ "#{r.first_name} #{r.last_name} - (#{r.email})", r.id ] },{:include_blank => true, :selected => client_location.poc_id}, class: 'form-control' %>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <%= form.label :soc_id, 'Secondary Ops Contact:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
                  <div class="col-md-8 col-sm-8">
                  <%= form.select :soc_id, ClientContact.where(:client_id => client_location.client_id).collect {|r| [ "#{r.first_name} #{r.last_name} - (#{r.email})", r.id ] },{:include_blank => true, :selected => client_location.soc_id}, class: 'form-control' %>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <label class="text-right col-md-2 col-sm-4 col-form-label"> is Origin?</label>
                  <div class="col-md-8 col-sm-8">
                    <input type="checkbox" name="origin" data-render="switchery" data-theme="default" data-secondary-color="rgb(255, 91, 87)" <%= is_origin ? 'checked' : '' %>/>
                  </div>
                </div>
                <div class="form-group row m-b-15">
                  <label class="text-right col-md-2 col-sm-4 col-form-label"> is Destination? </label>
                  <div class="col-md-8 col-sm-8">
                    <input type="checkbox" name="destination" data-render="switchery" data-theme="default" data-secondary-color="rgb(255, 91, 87)"  <%= is_destination ? 'checked' : '' %>/>
                  </div>
                </div>
                <div class="form-group row m-b-0">
                  <label class="text-right col-md-2 col-sm-4 col-form-label">&nbsp;</label>
                  <div class="col-md-8 col-sm-8">
                    <%= form.submit 'Submit', :class => 'btn btn-primary' %>
                    <% client = Client.find(client_location.client_id)%>
                    <% if params[:action] == 'edit' %>
                      &nbsp;&nbsp;<%= link_to 'Show', client, :class => 'btn btn-info' %>
                    <% end %>
                    <% if params[:action] == 'new' %>
                      &nbsp;&nbsp;<%= link_to 'Back', clients_path, :class => 'btn btn-default' %>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
</div>
<!-- end panel -->
<script language="javascript">
	populateCountries("client_location_country", "client_location_state");

</script>
