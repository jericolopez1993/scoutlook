<!-- begin page-header -->
<%#= render 'layouts/static/header', header_title: params[:action] == 'new' ? 'Create New Reminders' : "Edit Reminder - #{reminder.first_name} #{reminder.last_name}" %>
<!-- end page-header -->
<!-- begin panel -->
<div class="panel panel-inverse">
  <div class="panel <% if @client_type == "carrier" %> panel-scout <% elsif @client_type == "shipper"  %> panel-darkblue <% elsif @client_type == "activity" %> panel-yelloworange <% else %> panel-lightblue <% end %> ">
    <div class="panel-heading">
      <div class="panel-heading-btn">
      </div>
      <h4 class="panel-title lp-header"><%= params[:action] == 'new' ? 'Create New Reminders' : "Edit Reminder" %></h4>
    </div>
    <div class="panel-body">
      <%= form_with(model: reminder, local: true, :html => {class: 'form-horizontal', 'data-parsley-validate' => true}) do |form| %>
        <% if reminder.errors.any? %>
          <div id="error_explanation">
            <h2><%= pluralize(reminder.errors.count, "error") %> prohibited this client from being saved:</h2>
            <ul>
              <% reminder.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <% if @previous_controller == "carriers"%>
          <%= form.hidden_field :carrier_id %>
        <% elsif @previous_controller == "shippers"%>
          <%= form.hidden_field :shipper_id %>
        <% elsif @previous_controller == "activities"%>
          <%= form.hidden_field :activity_id %>
        <% else %>
          <% if @client_type == "carrier" || reminder.carrier %>
            <div class="form-group row m-b-15">
              <%= form.label :carrier_id, 'Carrier:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
              <div class="col-md-9 col-sm-8">
                <%= collection_select :reminder, :carrier_id, Carrier.all.order("company_name ASC"), :id, :company_name, {prompt: true, :selected => reminder.carrier_id}, {class: 'form-control'} %>
              </div>
            </div>
          <% elsif @client_type == "shipper" || reminder.shipper  %>
            <div class="form-group row m-b-15">
              <%= form.label :shipper_id, 'Shipper:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
              <div class="col-md-9 col-sm-8">
                <%= collection_select :reminder, :shipper_id, Shipper.all.order("company_name ASC"), :id, :company_name, {prompt: true, :selected => reminder.shipper_id}, {class: 'form-control'} %>
              </div>
            </div>
          <% elsif @client_type == "activity" || reminder.activity  %>
            <div class="form-group row m-b-15">
              <%= form.label :activity_id, 'Activity:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
              <div class="col-md-9 col-sm-8">
                <%= collection_select :reminder, :activity_id, Activity.all.order("campaign_name ASC"), :id, :display_select_name, {prompt: true, :selected => reminder.shipper_id}, {class: 'form-control'} %>
              </div>
            </div>
          <% end %>
        <% end %>
        <div class="form-group row m-b-15">
          <%= form.label :reminder_type, 'Type:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
          <div class="col-md-9 col-sm-8">
            <%= form.select :reminder_type, options_for_select(['Initial Interview', 'Check Capacity', 'Follow-up'], reminder.reminder_type),{:include_blank => true}, class: 'form-control', id: "reminder_type" %>
          </div>
        </div>
        <div class="form-group row m-b-15">
          <%= form.label :reminder_date, 'Reminder Date:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
          <div class="col-md-4 col-sm-8">
            <%= form.text_field :reminder_date, class: 'form-control datepicker-autoClose', 'data-inputmask' => "'alias': 'mm/dd/yyyy'"%>
          </div>
          <%= form.label :reminder_interval, 'OR Interval:', class: 'text-right col-md-1 col-sm-4 col-form-label' %>
          <div class="col-md-4 col-sm-8">
            <%= form.select :reminder_interval, options_for_select([['1w', 7], ['2w', 14], ['1M', 30], ['3M', 90], ['6M', 180], ['12M', 360]], reminder.reminder_interval),{:include_blank => true}, class: 'form-control', id: "reminder_interval" %>
          </div>
        </div>
        <div class="form-group row m-b-15 switch-block">
          <label class="text-right col-md-2 col-sm-4 col-form-label">is Recurring?</label>
          <div class="col-md-9 col-sm-8">
              <%= form.check_box :recurring, data: { render: 'switchery', theme: 'default', 'secondary-color': 'rgb(255, 91, 87)' }, checked: reminder.recurring %>
          </div>
        </div>
        <div class="form-group row m-b-15">
          <%= form.label :notes, 'Notes:', class: 'text-right col-md-2 col-sm-4 col-form-label' %>
          <div class="col-md-9 col-sm-8">
            <%= form.text_area(:notes, cols: 20, rows: 5, class: 'tinymce') %>
          </div>
        </div>
        <div class="form-group row m-b-0">
          <label class="text-right col-md-2 col-sm-4 col-form-label">&nbsp;</label>
          <div class="col-md-9 col-sm-8">
            <%= form.submit 'Submit', :class => 'btn btn-primary' %>
            <% if params[:action] == 'edit' %>
              &nbsp;&nbsp;<%= link_to 'Show', reminder, :class => 'btn btn-info' %>
            <% end %>
              &nbsp;&nbsp;<%= link_to 'Back', reminders_path, :class => 'btn btn-default' %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
<%= tinymce %>
<!-- end panel -->
<script type="text/javascript">
  $(".switchery").ready(function(){
    if ($('#reminder_interval').val() == "") {
      $('.switch-block').hide()
    }
  });
  $('#reminder_reminder_date').change(function(){
    if ($('#reminder_reminder_date').val() != "") {
        $('#reminder_interval').attr("disabled","disabled")
        $('.switchery').addClass('disable-switch');
    } else {
        $('#reminder_interval').removeAttr('disabled');
        $('.switchery').removeClass('disable-switch');
    }
  });
  $('#reminder_interval').change(function(){
    if ($('#reminder_interval').val() != "") {
        $('#reminder_reminder_date').attr("disabled","disabled")
        $('.switch-block').show()
    } else {
        $('#reminder_reminder_date').removeAttr('disabled');
        $('.switch-block').hide()
    }
  });
  $('#reminder_recurring').on('change', function(){
    if ($('#reminder_recurring').is(':checked')) {
        $('#reminder_reminder_date').attr("disabled","disabled")
    } else {
        $('#reminder_reminder_date').removeAttr('disabled');
    }
  });
</script>
