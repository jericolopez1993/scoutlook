<!-- begin vertical-box -->
<div class="vertical-box with-grid">
  <!-- begin vertical-box-column -->
  <div class="vertical-box-column width-200 bg-silver hidden-xs">
    <!-- begin vertical-box -->
    <div class="vertical-box">
      <!-- begin vertical-box-row -->
      <div class="vertical-box-row">
        <!-- begin vertical-box-cell -->
        <div class="vertical-box-cell">
          <!-- begin vertical-box-inner-cell -->
          <div class="vertical-box-inner-cell">
            <!-- begin scrollbar -->
            <div data-scrollbar="true" data-height="100%">
              <!-- begin wrapper -->
              <div class="wrapper p-0">
                <div class="nav-title"><b>FOLDERS</b></div>
                <ul class="nav nav-inbox">
                  <li class="<%= if @mtype == 'inbox' then "active" end %>"><a href="<%= mailings_path(:mtype => 'inbox') %>"><i class="fa fa-inbox fa-fw m-r-5"></i> Inbox</a></li>
                  <li class="<%= if @mtype == 'archive' then "active" end %>"><a href="<%= mailings_path(:mtype => 'archive') %>"><i class="fa fa-flag fa-fw m-r-5"></i> Archived</a></li>
                  <li class="<%= if @mtype == 'sent' then "active" end %>"><a href="<%= mailings_path(:mtype => 'sent') %>"><i class="fa fa-envelope fa-fw m-r-5"></i> Sent</a></li>
                  <li class="<%= if @mtype == 'trash' then "active" end %>"><a href="<%= mailings_path(:mtype => 'trash') %>"><i class="fa fa-trash fa-fw m-r-5"></i> Trash</a></li>
                </ul>
              </div>
              <!-- end wrapper -->
            </div>
            <!-- end scrollbar -->
          </div>
          <!-- end vertical-box-inner-cell -->
        </div>
        <!-- end vertical-box-cell -->
      </div>
      <!-- end vertical-box-row -->
    </div>
    <!-- end vertical-box -->
  </div>
  <!-- end vertical-box-column -->
  <!-- begin vertical-box-column -->
  <div class="vertical-box-column bg-white">
    <!-- begin vertical-box -->
    <div class="vertical-box">
      <!-- begin wrapper -->
      <div class="wrapper bg-silver-lighter">
        <!-- begin btn-toolbar -->
        <div class="btn-toolbar">
          <div class="btn-group m-r-5">
            <a href="javascript:;" class="p-t-5 pull-left m-r-3 m-t-2" data-click="email-select-all">
              <i class="far fa-square fa-fw text-muted f-s-16 l-minus-2"></i>
            </a>
          </div>
          <!-- begin btn-group -->
          <div class="btn-group m-r-5">
            <a href="<%= mailings_path(:mtype => @mtype) %>" class="btn btn-sm btn-white"><i class="fa fa-redo f-s-14 t-plus-1"></i></a>
          </div>
          <!-- end btn-group -->
          <!-- begin btn-group -->
          <div class="btn-group">
            <% if @mtype == "trash" %>
              <button class="btn btn-sm btn-danger hide" data-email-action="delete" id="delete-btn"><i class="fa t-plus-1 fa-times f-s-14 m-r-3"></i> <span class="hidden-xs">Delete Permanently</span></button>
            <% end %>
            <% if @mtype != "sent" %>
              <button class="btn btn-sm btn-green hide" data-email-action="to sent" id="to-sent-btn"><i class="fa t-plus-1 fa-envelope f-s-14 m-r-3"></i> <span class="hidden-xs">To Sent</span></button>
            <% end %>
            <% if @mtype != "archive" %>
              <button class="btn btn-sm btn-success hide" data-email-action="archive" id="archive-btn"><i class="fa t-plus-1 fa-folder f-s-14 m-r-3"></i> <span class="hidden-xs">Archive</span></button>
            <% end %>
            <% if @mtype != "trash" %>
              <button class="btn btn-sm btn-warning hide" data-email-action="trash" id="trash-btn"><i class="fa t-plus-1 fa-trash f-s-14 m-r-3"></i> <span class="hidden-xs">Trash</span></button>
            <% end %>

          </div>
          <!-- end btn-group -->
          <!-- begin btn-group -->
          <div class="btn-group ml-auto">
            <!-- <button class="btn btn-white btn-sm">
              <i class="fa fa-chevron-left f-s-14 t-plus-1"></i>
            </button>
            <button class="btn btn-white btn-sm">
              <i class="fa fa-chevron-right f-s-14 t-plus-1"></i>
            </button> -->
          </div>
          <!-- end btn-group -->
        </div>
        <!-- end btn-toolbar -->
      </div>
      <!-- end wrapper -->
      <!-- begin vertical-box-row -->
      <div class="vertical-box-row">
        <!-- begin vertical-box-cell -->
        <div class="vertical-box-cell">
          <!-- begin vertical-box-inner-cell -->
          <div class="vertical-box-inner-cell">
            <!-- begin scrollbar -->
            <div data-scrollbar="true" data-height="100%">
              <!-- begin list-email -->
              <ul class="list-group list-group-lg no-radius list-email" id="list-email">
                  <%= render 'mailings/row', mailings: @mailings %>
              </ul>
              <!-- end list-email -->
            </div>
            <!-- end scrollbar -->
          </div>
          <!-- end vertical-box-inner-cell -->
        </div>
        <!-- end vertical-box-cell -->
      </div>
      <!-- end vertical-box-row -->
      <!-- begin wrapper -->
      <div class="wrapper bg-silver-lighter clearfix">
        <!-- <div class="btn-group pull-right">
          <button class="btn btn-white btn-sm">
            <i class="fa fa-chevron-left f-s-14 t-plus-1"></i>
          </button>
          <button class="btn btn-white btn-sm">
            <i class="fa fa-chevron-right f-s-14 t-plus-1"></i>
          </button>
        </div> -->
        <div class="m-t-5 text-inverse f-w-600"><%= @mailings.length %> message/s</div>
      </div>
      <!-- end wrapper -->
    </div>
    <!-- end vertical-box -->
  </div>
  <!-- end vertical-box-column -->
</div>
<!-- end vertical-box -->
<script type="text/javascript">
  function getCheckboxValues(){
    mails = [];
    $.each($("input[data-checked=email-checkbox]:checked"), function(){
      mails.push($(this).val());
    });
    return mails;
  }
  function updateMails(mtype){
    mails = getCheckboxValues();
    $.ajax({
      url: "/api/mailings/update_mails",
      data: {
        mail_ids: mails,
        mtype: mtype
      },
      type: "POST",
      success: function(response) {

      }
    });
  }
  $(document).ready(function() {
    $('#delete-btn').click(function() {
      mails = getCheckboxValues();
      $.ajax({
        url: "/api/mailings/delete_mails",
        data: {
          mail_ids: mails
        },
        type: "POST",
        success: function(response) {

        }
      });
    });
    $('#to-sent-btn').click(function() {
      updateMails('sent');
    });
    $('#archive-btn').click(function() {
      updateMails('archive');
    });
    $('#trash-btn').click(function() {
      updateMails('trash');
    });

  });
</script>
