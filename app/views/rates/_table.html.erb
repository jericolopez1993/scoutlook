<% if params[:controller] == "rates" %>
  <style>
    .tooltip-inner {
      background-color: #033309!important;
    }
    .tooltip .arrow::before{
      border-right-color: #033309!important;
    }
  </style>
<% end %>
<table table class="table table-striped table-bordered display nowrap"  id="rates_table">
  <thead>
    <tr class="odd gradeX">
      <th>Origin City</th>
      <th>Origin ST/PV</th>
      <th>Destination City</th>
      <th>Destination ST/PV</th>
      <th>Miles</th>
      <th>Picks</th>
      <th>Drops</th>
      <th>Team</th>
      <th>Commodities</th>
      <th>Bid</th>
      <th>Ask</th>
      <th>Accepted</th>
      <th>Cost</th>
      <th>Currency</th>
      <th>MC #</th>
      <th>Notes</th>
      <th>Carrier</th>
      <th>Shipper</th>
      <% if with_actions %>
        <th data-orderable="false">Actions</th>
      <% end %>
    </tr>
  </thead>
  <tfoot>
    <tr>
      <th>Origin City</th>
      <th>Origin ST/PV</th>
      <th>Destination City</th>
      <th>Destination ST/PV</th>
      <th>Miles</th>
      <th>Picks</th>
      <th>Drops</th>
      <th>Team</th>
      <th>Commodities</th>
      <th>Bid</th>
      <th>Ask</th>
      <th>Accepted</th>
      <th>Cost</th>
      <th>Currency</th>
      <th>MC #</th>
      <th>Notes</th>
      <th>Carrier</th>
      <th>Shipper</th>
      <% if with_actions %>
        <th data-orderable="false">Actions</th>
      <% end %>
    </tr>
  </tfoot>
  <tbody class="spacer">
    <% rates.each do |rate| %>
      <tr>
        <td><%= rate.origin_city %></td>
        <td><%= rate.origin_state %></td>
        <td><%= rate.destination_city %></td>
        <td><%= rate.destination_state %></td>
        <td><%= rate.miles %></td>
        <td><%= rate.picks %></td>
        <td><%= rate.drops %></td>
        <td>
          <% if rate.team == "Yes" %>
            <b class="text-success"><%= rate.team %></b>
          <% else %>
            <b class="text-danger"><%= rate.team %></b>
          <% end %>
        </td>
        <td>
          <% rate.commodities_to_array.each do |cr| %>
            <span class="badge badge-inverse"><%= cr %></span>
          <% end %>
        </td>
        <td><%= rate.bid %></td>
        <td><%= rate.ask %></td>
        <td><%= rate.accepted ? "<b class='text-success'>Yes</b>".html_safe : "<i class='text-danger'>No</i>".html_safe %></td>
        <td><%= rate.cost %></td>
        <td><%= rate.money_currency %></td>
        <td><%= rate.mc_number %></td>
        <td><%= rate.notes %></td>

        <td>
          <span
            data-toggle="tooltip"
            data-placement="right"
            data-html="true"
            title="
              <b>Name</b>: <%= rate.activity.carrier && (rate.activity.carrier.company_name.blank? ? "(no name)" : rate.activity.carrier.company_name) %><br>
              <b>Ops Name</b>: <%= rate.activity.carrier && (rate.activity.carrier.poc.nil? ? '' : rate.activity.carrier.poc.full_name) %><br>
              <b>Ops Phone</b>: <%= rate.activity.carrier && (rate.activity.carrier.poc.nil? ? '' : ((!rate.activity.carrier.poc.primary_phone.nil? && rate.activity.carrier.poc.primary_phone != "") ? (rate.activity.carrier.poc.primary_phone + " (#{rate.activity.carrier.poc.primary_phone_type})") : "")) %><br>
              <b>Ops Email</b>: <%= rate.activity.carrier && (rate.activity.carrier.poc.nil? ? '' : rate.activity.carrier.poc.email) %><br>
              <b>Class</b>: <%= rate.activity.carrier && (rate.activity.carrier.sales_priority) %><br>
              <b>MC Number</b>: <%= rate.activity.carrier && (rate.activity.carrier.mc_number) %><br>
              <b>Sate/Province</b>: <%= rate.activity.carrier && (rate.activity.carrier.location.nil? ? '' : rate.activity.carrier.location.state) %><br>
              <b>Last Contact Date</b>: <%= rate.activity.carrier && (rate.activity.carrier.last_contact_date.nil? || rate.activity.carrier.last_contact_date.date_opened.nil? ? "" : rate.activity.carrier.last_contact_date.date_opened.strftime('%d/%m/%Y').to_s) %><br>
            ">
          <%= rate.activity.carrier && link_to(rate.activity.carrier.company_name.blank? ? "(no name)" : rate.activity.carrier.company_name, rate.activity.carrier) %>
          </span>
        </td>
        <td>
          <span
            data-toggle="tooltip"
            data-placement="right"
            data-html="true"
            title="
              <b>Name</b>: <%= rate.activity.shipper && (rate.activity.shipper.company_name.blank? ? "(no name)" : rate.activity.shipper.company_name) %><br>
              <b>DM Name</b>: <%= rate.activity.shipper && (rate.activity.shipper.pdm.nil? ? '' : rate.activity.shipper.pdm.full_name) %><br>
              <b>DM Phone</b>: <%= rate.activity.shipper && (rate.activity.shipper.pdm.nil? ? '' : ((!rate.activity.shipper.pdm.primary_phone.nil? && rate.activity.shipper.pdm.primary_phone != "") ? (rate.activity.shipper.pdm.primary_phone + " (#{rate.activity.shipper.pdm.primary_phone_type})") : "")) %><br>
              <b>DM Email</b>: <%= rate.activity.shipper && (rate.activity.shipper.pdm.nil? ? '' : rate.activity.shipper.pdm.email) %><br>
              <b>Class</b>: <%= rate.activity.shipper && (rate.activity.shipper.sales_priority) %><br>
              <b>City</b>: <%= rate.activity.shipper && (rate.activity.shipper.location.nil? ? '' : rate.activity.shipper.location.city) %><br>
              <b>Sate/Province</b>: <%= rate.activity.shipper && (rate.activity.shipper.location.nil? ? '' : rate.activity.shipper.location.state) %><br>
              <b>Last Contact Date</b>: <%= rate.activity.shipper && (rate.activity.shipper.last_contact_date.nil? || rate.activity.shipper.last_contact_date.date_opened.nil? ? "" : rate.activity.shipper.last_contact_date.date_opened.strftime('%d/%m/%Y').to_s) %><br>
            ">
          <%= rate.activity.shipper && link_to(rate.activity.shipper.company_name.blank? ? "(no name)" : rate.activity.shipper.company_name, rate.activity.shipper) %>
          </span>
        </td>
        <% if with_actions %>
          <td>
            <%= link_to '<i class="far fa-eye"></i>'.html_safe, rate_path(:id => rate.id, :previous_controller => params[:controller]), :class => 'btn btn-info btn-xs' %>
            <%= link_to '<i class="far fa-edit"></i>'.html_safe, edit_rate_path(rate, :previous_controller => params[:controller]), :class => 'btn btn-warning btn-xs' %>
            <%= link_to '<i class="fas fa-trash-alt"></i>'.html_safe, rate_path(:id => rate.id, :previous_controller => params[:controller]), method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-danger btn-xs'%>
          </td>
      <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<script language="javascript">
  $(document).ready(function() {
    filterTable("rates_table");
  });
</script>
