<style>
  .badge a {
    color: #fff!important;
  }
  td.link a:visited {
    color: #013a38!important;
  }
</style>
<% if params[:controller] == "shippers" %>
  <style media="screen">
  .tooltip-inner {
    background-color: #013a38!important;
  }
  .tooltip .arrow::before{
    border-right-color: #013a38!important;
  }
  </style>
<% end %>
<!-- begin panel -->
<div style="width: 100%">
  <div class="panel panel-darkblue">
    <div class="panel-heading">
      <div class="panel-heading-btn">
        <%= link_to 'New Shipper', new_shipper_path, :class => 'btn btn-success btn-xs' %>
      </div>
      <h4 class="panel-title lp-header">Shippers</h4>
    </div>
    <div class="panel-body">
      <table class="table table-striped table-bordered display" data-order="[[1, &quot;asc&quot;]]" id="shipper_table">
        <thead>
          <tr>
            <th></th>
            <th width="150px">Name</th>
            <th>DM Name</th>
            <th>DM Phone</th>
            <th>DM Email</th>
            <th>Lane 1</th>
            <th>Lane 2</th>
            <th>Approved</th>
            <th>RO</th>
            <th>Class</th>
            <th>CR</th>
            <th>LstDateCon</th>
            <th>1M</th>
            <th>6M</th>
            <th>City</th>
            <th>ST/PV</th>
            <th>LPM</th>
            <th width="250px">Commodities</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <th></th>
            <th>Name</th>
            <th>DM Name</th>
            <th>DM Phone</th>
            <th>DM Email</th>
            <th>Lane 1</th>
            <th>Lane 2</th>
            <th>Approved</th>
            <th>RO</th>
            <th>Class</th>
            <th>CR</th>
            <th>LstDateCon</th>
            <th>1M</th>
            <th>6M</th>
            <th>City</th>
            <th>ST/PV</th>
            <th>LPM</th>
            <th width="250px">Commodities</th>
          </tr>
        </tfoot>
        <tbody class="spacer">
          <% @shippers.each do |shipper| %>
            <tr>
              <td></td>
              <td class="link">
                <span
                  data-toggle="tooltip"
                  data-placement="right"
                  data-html="true"
                  title="
                    <b>Name</b>: <%= shipper.company_name.blank? ? "(no name)" : shipper.company_name %><br>
                    <b>DM Name</b>: <%= shipper.pdm.nil? ? '' : shipper.pdm.full_name %><br>
                    <b>DM Phone</b>: <%= shipper.pdm.nil? ? '' : ((!shipper.pdm.primary_phone.nil? && shipper.pdm.primary_phone != "") ? (shipper.pdm.primary_phone + " (#{shipper.pdm.primary_phone_type})") : "") %><br>
                    <b>DM Email</b>: <%= shipper.pdm.nil? ? '' : shipper.pdm.email.downcase %><br>
                    <b>Class</b>: <%= shipper.sales_priority %><br>
                    <b>City</b>: <%= shipper.location.nil? ? '' : shipper.location.city %><br>
                    <b>Sate/Province</b>: <%= shipper.location.nil? ? '' : shipper.location.state %><br>
                    <b>Last Contact Date</b>: <%= shipper.last_contact_date.nil? || shipper.last_contact_date.date_opened.nil? ? "" : shipper.last_contact_date.date_opened.strftime('%d/%m/%Y').to_s %><br>
                  ">
                    <%= link_to shipper.company_name.blank? ? "(no name)" : shipper.company_name, shipper %>
                </span>
              </td>
              <td nowrap><%= shipper.pdm.nil? ? '' : shipper.pdm.full_name %></td>
              <td nowrap><b>
                <% if shipper.pdm && shipper.pdm.primary_eligible_texting %>
                  <%= shipper.pdm.primary_phone %> (TEXT)
                <% else %>
                  <%= shipper.pdm.nil? ? '' : ((!shipper.pdm.primary_phone.nil? && shipper.pdm.primary_phone != "") ? (shipper.pdm.primary_phone + ((!shipper.pdm.primary_extension_number.nil? && shipper.pdm.primary_extension_number != "") ? (", Ext. " + shipper.pdm.primary_extension_number) : "") + ((shipper.pdm.primary_phone_type != "") ? (" (#{shipper.pdm.primary_phone_type})") : "")) : "") %></b></td>
                <% end %>
              <td nowrap><% if !shipper.pdm.nil?  %><a href="mailto:<%= shipper.pdm.email %>?Subject=Hello%20<%= shipper.pdm.first_name.nil? ? '' :  shipper.pdm.first_name.capitalize + " " + shipper.pdm.last_name.capitalize  %>" target="_top"><%= shipper.pdm.email.downcase %>&nbsp;<i class="far fa-envelope"></i></a><% end %></td>
              <td nowrap>
                <% shipper.lane_1.each do |lane| %>
                  <% if !lane.lane_origin.nil? && lane.lane_origin != "" %>
                    <% lane.lane_origin_to_array.each do |origin| %>
                      <% if Shipper::LIGHT_BLUE.include?(origin) %>
                        <span class="badge badge-primary"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::DARK_BLUE.include?(origin) %>
                        <span class="badge badge-drakblue"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::BLUE.include?(origin) %>
                        <span class="badge badge-info"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::RED.include?(origin) %>
                      <span class="badge badge-scout"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::BROWN.include?(origin) %>
                        <span class="badge badge-brown"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::YELLOW.include?(origin) %>
                        <span class="badge badge-yellow"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::ORANGE.include?(origin) %>
                        <span class="badge badge-warning"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::GREEN.include?(origin) %>
                        <span class="badge badge-green"><%= link_to(origin, lane) %></span>
                      <% end %>
                    <% end %>
                    &rarr;
                  <% end %>
                  <% lane.lane_destination_to_array.each do |destination| %>
                    <% if Shipper::LIGHT_BLUE.include?(destination) %>
                      <span class="badge badge-primary"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::DARK_BLUE.include?(destination) %>
                      <span class="badge badge-drakblue"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::BLUE.include?(destination) %>
                      <span class="badge badge-info"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::RED.include?(destination) %>
                    <span class="badge badge-scout"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::BROWN.include?(destination) %>
                      <span class="badge badge-brown"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::YELLOW.include?(destination) %>
                      <span class="badge badge-yellow"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::ORANGE.include?(destination) %>
                      <span class="badge badge-warning"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::GREEN.include?(destination) %>
                      <span class="badge badge-green"><%= link_to(destination, lane) %></span>
                    <% end %>
                  <% end %>
                  <br>
                <% end %>
              </td>
              <td nowrap>
                <% shipper.lane_2.each do |lane| %>
                  <% if !lane.lane_origin.nil? && lane.lane_origin != "" %>
                    <% lane.lane_origin_to_array.each do |origin| %>
                      <% if Shipper::LIGHT_BLUE.include?(origin) %>
                        <span class="badge badge-primary"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::DARK_BLUE.include?(origin) %>
                        <span class="badge badge-drakblue"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::BLUE.include?(origin) %>
                        <span class="badge badge-info"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::RED.include?(origin) %>
                      <span class="badge badge-scout"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::BROWN.include?(origin) %>
                        <span class="badge badge-brown"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::YELLOW.include?(origin) %>
                        <span class="badge badge-yellow"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::ORANGE.include?(origin) %>
                        <span class="badge badge-warning"><%= link_to(origin, lane) %></span>
                      <% elsif Shipper::GREEN.include?(origin) %>
                        <span class="badge badge-green"><%= link_to(origin, lane) %></span>
                      <% end %>
                    <% end %>
                    &rarr;
                  <% end %>
                  <% lane.lane_destination_to_array.each do |destination| %>
                    <% if Shipper::LIGHT_BLUE.include?(destination) %>
                      <span class="badge badge-primary"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::DARK_BLUE.include?(destination) %>
                      <span class="badge badge-drakblue"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::BLUE.include?(destination) %>
                      <span class="badge badge-info"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::RED.include?(destination) %>
                    <span class="badge badge-scout"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::BROWN.include?(destination) %>
                      <span class="badge badge-brown"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::YELLOW.include?(destination) %>
                      <span class="badge badge-yellow"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::ORANGE.include?(destination) %>
                      <span class="badge badge-warning"><%= link_to(destination, lane) %></span>
                    <% elsif Shipper::GREEN.include?(destination) %>
                      <span class="badge badge-green"><%= link_to(destination, lane) %></span>
                    <% end %>
                  <% end %>
                  <br>
                <% end %>
              </td>
              <td class="text-center"><%= shipper.approved ? "<b class='text-success'>Y</b>".html_safe : "<i class='text-danger'>N</i>".html_safe %></td>
              <td nowrap class="text-center link"><%= shipper.relationship_owner_user.nil? ? '' : "#{link_to("#{shipper.relationship_owner_user.first_name[0]}#{shipper.relationship_owner_user.last_name[0]}", shipper.relationship_owner_user)}".html_safe %></td>
              <td class="text-center"><%= shade_sales_priority(shipper.sales_priority).html_safe %></td>
              <td class="text-center"><%= shipper.complete_record ? "<b class='text-success'>Y</b>".html_safe : "<i class='text-danger'>N</i>".html_safe %></td>
              <td nowrap><%= shipper.last_contact_date.nil? || shipper.last_contact_date.date_opened.nil? ? "" : shipper.last_contact_date.date_opened.strftime('%d/%m/%Y').to_s %></td>
              <td nowrap><%= shipper.load_last_month %></td>
              <td nowrap><%= shipper.load_last_6_month %></td>
              <td nowrap><%= shipper.location.nil? ? '' : shipper.location.city %></td>
              <td nowrap><%= shipper.location.nil? ? '' : shipper.location.state %></td>
              <td nowrap><%= shipper.loads_per_month %></td>

              <td>
                <% shipper.commodities_to_array.each do |cr| %>
                  <span class="badge badge-inverse"><%= cr %></span>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script language="javascript">
  $(document).ready(function() {
     filterTable("shipper_table");
  });
</script>

<!-- end panel -->
