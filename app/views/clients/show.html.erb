
<!-- begin page-header -->
<%= render 'layouts/static/header', header_title: 'Clients', sub_header_title: 'Create/Edit/View'%>
<!-- end page-header -->
<!-- begin row -->
<div class="row">
      <!-- begin col-6 -->
      <div class="col-lg-6">
    <!-- begin panel -->
      <div class="panel panel-inverse">
        <div class="panel-heading">
          <div class="panel-heading-btn">
            <%= link_to 'Edit', edit_client_path(@client), :class => 'btn btn-warning btn-xs' %>
            <%= link_to 'Back', clients_path, :class => 'btn btn-info btn-xs' %>
          </div>
          <h4 class="panel-title"><%= @client.company_name %></h4>
        </div>
        <div class="panel-body">
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">ID:</label>
            <div class="col-md-7">
              <%= generate_alphanumeric_id(@client.client_type, @client.id) %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Type:</label>
            <div class="col-md-7">
              <%= @client.client_type %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Rep's Name:</label>
            <div class="col-md-7">
              <% if @client.relationship_owner.present? && !@client.relationship_owner.nil?%>
                <%= link_to "#{@client.rep.first_name} #{@client.rep.last_name} (#{generate_alphanumeric_id(@client.rep.last_name, @client.rep.id)})", rep_path(:id => @client.relationship_owner) %>
              <% end %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Sales priority:</label>
            <div class="col-md-7">
              <%= @client.sales_priority %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Phone:</label>
            <div class="col-md-7">
              <%= @client.phone %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Annual Revenue:</label>
            <div class="col-md-7">
              <%= @client.annual_revenue %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Industry:</label>
            <div class="col-md-7">
              <%= @client.industry %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Primary Industry:</label>
            <div class="col-md-7">
              <%= @client.primary_industry %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Hazardous:</label>
            <div class="col-md-7">
              <%= @client.hazardous %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Food Grade:</label>
            <div class="col-md-7">
              <%= @client.food_grade %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Freight Revenue:</label>
            <div class="col-md-7">
              <%= @client.freight_revenue %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Credit Status:</label>
            <div class="col-md-7">
              <%= @client.credit_status %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Credit Approval:</label>
            <div class="col-md-7">
              <%= @client.credit_approval %>
            </div>
          </div>


        </div>
      </div>
      <div class="panel panel-inverse">
        <div class="panel-heading">
          <div class="panel-heading-btn">
          </div>
          <h4 class="panel-title">Volume</h4>
        </div>
        <div class="panel-body">
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Intra:</label>
            <div class="col-md-7">
              <%= @client.volume_intra %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Inter:</label>
            <div class="col-md-7">
              <%= @client.volume_inter %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">to USA:</label>
            <div class="col-md-7">
              <%= @client.volume_to_usa %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">from USA:</label>
            <div class="col-md-7">
              <%= @client.volume_from_usa %>
            </div>
          </div>
          <div class="form-group row m-b-15">
            <label class="col-md-3 col-form-label">Notes:</label>
            <div class="col-md-7">
              <%= @client.notes.nil? ? "" : @client.notes.html_safe %>
            </div>
          </div>


        </div>
      </div>
      <div class="panel panel-inverse">
        <div class="panel-heading">
          <h4 class="panel-title">Attachments</h4>
        </div>
        <div class="panel-body">
          <% @client.attachment_file.each do |attachment_file| %>
            <%= link_to attachment_file.filename, rails_blob_path(attachment_file, disposition: 'preview') %><br />
          <% end %>
        </div>
      </div>
  </div>
  <div class="col-lg-6">
<!-- begin panel -->

<!-- begin page-header -->
<!-- end page-header -->
<!-- begin panel -->
<div class="panel panel-inverse">
  <div class="panel-heading">
    <h4 class="panel-title">Inbound Shipments</h4>
  </div>
  <div class="panel-body">
    <%= render 'shipments', shipments: Shipment.where(:destination_id => @client.id) %>
  </div>
</div>
<div class="panel panel-inverse">
  <div class="panel-heading">
    <h4 class="panel-title">Outbound Shipments</h4>
  </div>
  <div class="panel-body">
    <%= render 'shipments', shipments: Shipment.where(:origin_id => @client.id) %>
  </div>
</div>
<!-- end panel -->

<div class="panel panel-inverse">
  <div class="panel-heading">
    <div class="panel-heading-btn">
      <%= link_to 'New Location', new_client_location_path(:client_id => @client.id), :class => 'btn btn-primary btn-xs' %>
    </div>
    <h4 class="panel-title">Locations</h4>
  </div>
  <div class="panel-body">
    <table id="data-table-buttons" class="table table-striped table-bordered data-table-buttons">
                    <thead>
                      <tr class="odd gradeX">
                        <th width="1%">Head Office</th>
                        <th width="1%">Origin</th>
        								<th width="1%">Destination</th>
                        <th width="1%">#</th>
                        <th class="text-nowrap">Name</th>
                        <th class="text-nowrap">Type</th>
                        <th class="text-nowrap">Address</th>
                        <th class="text-nowrap">Country</th>
                        <th class="text-nowrap">State</th>
                        <th class="text-nowrap">Phone</th>
                        <th class="text-nowrap" data-orderable="false">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% ClientLocation.where(:client_id => @client.id).each do |client_location| %>
                        <tr>
                          <td style="text-align: center;"><%= (@client.head_office == client_location.id) ? '<i class="text-green fas fa-check"></i>'.html_safe : '' %></td>
                          <td style="text-align: center;"><%= (@client.origin == client_location.id) ? '<i class="text-green fas fa-check"></i>'.html_safe : '' %></td>
                          <td style="text-align: center;"><%= (@client.destination == client_location.id) ? '<i class="text-green fas fa-check"></i>'.html_safe : '' %></td>
                          <td><%= generate_alphanumeric_id(client_location.loc_type, client_location.id) %></td>
                          <td><%= client_location.name %></td>
                          <td><%= client_location.loc_type %></td>
                          <td><%= client_location.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.address) : client_location.address %></td>
                          <td><%= client_location.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.country) : client_location.country %></td>
                          <td><%= client_location.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.state) : client_location.state %></td>
                          <td><%= client_location.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.phone) : client_location.phone %></td>
                          <td>
                            <%= link_to '<i class="far fa-edit"></i>'.html_safe, edit_client_location_path(client_location), :class => 'btn btn-warning' %>
                            <%= link_to '<i class="fas fa-trash-alt"></i>'.html_safe, client_location, method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-danger'%>
                          </td>

                        </tr>
                      <% end %>
                    </tbody>
                  </table>
  </div>
</div>
<div class="panel panel-inverse">
  <div class="panel-heading">
    <div class="panel-heading-btn">
    <%= link_to 'New Contact', new_client_contact_path(:client_id => @client.id), :class => 'btn btn-primary btn-xs' %>
    </div>
    <h4 class="panel-title">Contacts</h4>
  </div>
  <div class="panel-body">
    <table id="data-table-buttons" class="table table-striped table-bordered data-table-buttons">
                    <thead>
                      <tr class="odd gradeX">
      									<th width="1%">PDM</th>
        								<th width="1%">POC</th>
                        <th class="text-nowrap">Name</th>
                        <th class="text-nowrap">Email</th>
                        <th class="text-nowrap">Address</th>
                        <th class="text-nowrap">Work Phone</th>
                        <th class="text-nowrap">Cell</th>
                        <th class="text-nowrap" data-orderable="false">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% ClientContact.where(:client_id => @client.id).each do |contact| %>
                        <tr>
                          <td style="text-align: center;"><%= (@client.pdm_id == contact.id) ? '<i class="text-green fas fa-check"></i>'.html_safe : '' %></td>
                          <td style="text-align: center;"><%= (@client.poc_id == contact.id) ? '<i class="text-green fas fa-check"></i>'.html_safe : '' %></td>
                          <td><%= contact.name %></td>
                          <td><%= contact.email %></td>
                          <td><%= contact.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.address) : contact.address %></td>
                          <td><%= contact.same_ho ? (@client.head_office_location.nil? ? '' : @client.head_office_location.phone) : contact.work_phone %></td>
                          <td><%= contact.home_phone %></td>
                          <td>
                            <a class="btn btn-warning" href="<%= edit_client_contact_path(contact) %>"><i class="far fa-edit"></i></a>&nbsp;
                            <a data-confirm="Are you sure?" class="btn btn-danger" rel="nofollow" data-method="delete" href="/client_contacts/<%= contact.id %>"><i class="far fa-trash-alt"></i></a>
                          </td>

                        </tr>
                      <% end %>
                    </tbody>
                  </table>
  </div>
</div>
<div class="panel panel-inverse">
  <div class="panel-heading">
    <div class="panel-heading-btn">
    <%= link_to 'New Activity', new_activity_path(:client_id => @client.id, :previous_controller => params[:controller]), :class => 'btn btn-primary btn-xs' %>
    </div>
    <h4 class="panel-title">Activities</h4>
  </div>
  <div class="panel-body">
    <table id="data-table-buttons" class="table table-striped table-bordered data-table-buttons">
      <thead>
        <tr class="odd gradeX">
          <th width="1%">#</th>
          <th class="text-nowrap">Type</th>
          <th class="text-nowrap">Rep</th>
          <th class="text-nowrap">Annual Value</th>
          <th class="text-nowrap">Status</th>
          <th class="text-nowrap">Date Opened</th>
          <th class="text-nowrap">Date Closed</th>
          <th class="text-nowrap" data-orderable="false">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% Activity.where(:client_id => @client.id).each do |activity| %>
          <tr>
            <td><%= generate_alphanumeric_id(activity.activity_type, activity.id) %></td>
            <td><%= activity.activity_type %></td>
            <td><%= activity.rep_id %></td>
            <td><%= activity.annual_value %></td>
            <td><%= activity.status ? 'Open' : 'Closed' %></td>
            <td><%= activity.date_opened %></td>
            <td><%= activity.date_closed %></td>
            <td>
              <%= link_to '<i class="far fa-eye"></i>'.html_safe, activity_path(:id => activity.id, :previous_controller => params[:controller]), :class => 'btn btn-info' %>
              <%= link_to '<i class="far fa-edit"></i>'.html_safe, edit_activity_path(:id => activity.id, :previous_controller => params[:controller]), :class => 'btn btn-warning' %>
              <%= link_to '<i class="fas fa-trash-alt"></i>'.html_safe, activity_path(:id => activity.id, :previous_controller => params[:controller]), method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-danger'%>
            </td>

          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
<div class="panel panel-inverse">
  <div class="panel-heading">
    <div class="panel-heading-btn">
    <%= link_to 'New Rates', new_rate_path(:client_id => @client.id, :previous_controller => params[:controller]), :class => 'btn btn-primary btn-xs' %>
    </div>
    <h4 class="panel-title">Rates</h4>
  </div>
  <div class="panel-body">
    <table id="data-table-buttons" class="table table-striped table-bordered data-table-buttons">
      <thead>
        <tr class="odd gradeX">
          <th width="1%">#</th>
          <th class="text-nowrap">Level</th>
          <th class="text-nowrap">Rep</th>
          <th class="text-nowrap">Type</th>
          <th class="text-nowrap">Parent</th>
          <th class="text-nowrap" data-orderable="false">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% Rate.where(:client_id => @client.id).each do |rate| %>
          <tr>
            <td><%= generate_alphanumeric_id(rate.rate_type, rate.id) %></td>
            <td><%= rate.rate_level %></td>
            <td><%= rate.rep.nil? ? "" : "#{generate_alphanumeric_id(rate.rep.last_name, rate.rep_id)}" %></td>
            <td><%= rate.rate_type %></td>
            <td><%= rate.parent.nil? ? "" : "#{generate_alphanumeric_id(rate.parent.rate_type, rate.parent_id)}" %></td>
            <td>
              <%= link_to '<i class="far fa-eye"></i>'.html_safe, rate_path(:id => rate.id, :previous_controller => params[:controller]), :class => 'btn btn-info' %>
              <%= link_to '<i class="far fa-edit"></i>'.html_safe, edit_rate_path(:id => rate.id, :previous_controller => params[:controller]), :class => 'btn btn-warning' %>
              <%= link_to '<i class="fas fa-trash-alt"></i>'.html_safe, rate_path(:id => rate.id, :previous_controller => params[:controller]), method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-danger'%>
            </td>
          </tr>
        <% end %>

      </tbody>

    </table>
  </div>
</div>
</div>

</div>
<!-- end panel -->
